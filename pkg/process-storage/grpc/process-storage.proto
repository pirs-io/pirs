syntax = "proto3";

package grpc;
option go_package = "./;grpc";

service Storage {

  rpc UploadProcess(stream ProcessUploadRequest) returns (stream ProcessUploadResponse) {}
  rpc DownloadProcess(ProcessDownloadRequest) returns (stream ProcessDownloadResponse) {}

}

message ProcessUploadRequest {
  ProcessFileData data = 1;
}

message ProcessUploadResponse {
  UploadStatus status = 1;
}

message ProcessMetadata {
  string process_id = 1;
  string filename = 2;
  Encoding encoding = 3;
  ProcessType type = 4;
}
message ProcessFileData {
  oneof data {
    ProcessMetadata metadata = 1;
    bytes chunk = 2;
  }
}

message ProcessDownloadRequest {
  string process_id = 1;
}

message ProcessDownloadResponse {
  ProcessFileData data = 1;
}

enum Encoding {
  UTF8 = 0;
}

enum ProcessType {
  PETRIFLOW = 0;
  BPMN = 1;
}

enum UploadStatus {
  PENDING = 0;
  IN_PROGRESS = 1;
  SUCCESS = 2;
  FAILED = 3;
}